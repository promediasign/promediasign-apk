plugins {
    id 'com.android.application'
}

android {
    namespace 'sign.promedia.ltd'
    compileSdk 34

    defaultConfig {
        applicationId "sign.promedia.ltd"
        minSdk 21
        targetSdk 34
        versionCode 5000262
        versionName "4.9.5"
        
        // Important: Keep existing DEX files
        multiDexEnabled true
    }

    signingConfigs {
        release {
            storeFile file('../signing-key.keystore')
            storePassword System.getenv("KEYSTORE_PASSWORD") ?: '11Mesahast'
            keyAlias System.getenv("KEY_ALIAS") ?: 'upload'
            keyPassword System.getenv("KEY_PASSWORD") ?: '11Mesahast'
        }
    }

    buildTypes {
        release {
            minifyEnabled false
            signingConfig signingConfigs.release
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

    packagingOptions {
        // Include pre-compiled DEX files
        jniLibs {
            useLegacyPackaging = true
        }
        resources {
            excludes += ['META-INF/DEPENDENCIES', 'META-INF/LICENSE', 'META-INF/LICENSE.txt', 'META-INF/license.txt', 'META-INF/NOTICE', 'META-INF/NOTICE.txt', 'META-INF/notice.txt', 'META-INF/ASL2.0', 'META-INF/*.kotlin_module']
        }
    }
    
    // Include the pre-compiled dex files
    sourceSets {
        main {
            java.srcDirs = []
        }
    }
}

dependencies {
    // No dependencies
}
